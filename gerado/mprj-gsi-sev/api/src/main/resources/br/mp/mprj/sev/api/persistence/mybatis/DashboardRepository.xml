<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="br.mp.mprj.sev.api.persistence.mybatis.DashboardRepository">

    <resultMap id="histogramDto" type="br.mp.mprj.sev.domain.dto.HistogramDto">
        <result column="label" property="label"/>
        <result column="value" property="value"/>
    </resultMap>

	<select id="allCount" resultMap="histogramDto">
        select * from (
            (select 'Candidato' as label, count(*) as value from SEVO_CANDIDATO) union
            (select 'Cedula' as label, count(*) as value from SEVO_CEDULA) union
            (select 'Eleicao' as label, count(*) as value from SEVO_ELEICAO) union
            (select 'Eleitor' as label, count(*) as value from SEVO_ELEITOR) union
            (select 'Evento' as label, count(*) as value from SEVO_EVENTO) union
            (select 'Integrante Comissao' as label, count(*) as value from SEVO_INTEGRANTE_COMISSAO)
        ) allCount
	</select>

    <select id="getResultadoApuracaoCollectionWithSumCandidatoQtVotos" resultMap="histogramDto">
        select * from (
            select
                Candidato.SCAD_DK ,
                Candidato.SCAD_NM_CANDIDATO as label,
                NVL( sum(o.REAP_QT_VOTOS), 0) as value
            from SEVO_CANDIDATO Candidato
            inner join SEVO_RESULTADO_APURACAO o on o.REAP_DK = Candidato.SCAD_DK
            group by Candidato.SCAD_DK, Candidato.SCAD_NM_CANDIDATO
            order by sum(o.REAP_QT_VOTOS) desc
        ) where rownum <![CDATA[ < ]]> 11
    </select>
    <select id="getCandidatoCollectionWithSumEleicaoCriterioDesempate" resultMap="histogramDto">
        select * from (
            select
                Eleicao.SELE_DK ,
                Eleicao.SELE_NM_ELEICAO as label,
                NVL( sum(o.SCAD_CRITERIO_DESEMPATE), 0) as value
            from SEVO_ELEICAO Eleicao
            inner join SEVO_CANDIDATO o on o.SCAD_DK = Eleicao.SELE_DK
            group by Eleicao.SELE_DK, Eleicao.SELE_NM_ELEICAO
            order by sum(o.SCAD_CRITERIO_DESEMPATE) desc
        ) where rownum <![CDATA[ < ]]> 11
    </select>
    <select id="getEleitorCollectionWithSumEleicaoVersao" resultMap="histogramDto">
        select * from (
            select
                Eleicao.SELE_DK ,
                Eleicao.SELE_NM_ELEICAO as label,
                NVL( sum(o.SEIT_VERSAO), 0) as value
            from SEVO_ELEICAO Eleicao
            inner join SEVO_ELEITOR o on o.SEIT_DK = Eleicao.SELE_DK
            group by Eleicao.SELE_DK, Eleicao.SELE_NM_ELEICAO
            order by sum(o.SEIT_VERSAO) desc
        ) where rownum <![CDATA[ < ]]> 11
    </select>
    <select id="getUrnaCollectionWithSumEleicaoVersao" resultMap="histogramDto">
        select * from (
            select
                Eleicao.SELE_DK ,
                Eleicao.SELE_NM_ELEICAO as label,
                NVL( sum(o.URNA_VERSAO), 0) as value
            from SEVO_ELEICAO Eleicao
            inner join SEVO_URNA o on o.URNA_DK = Eleicao.SELE_DK
            group by Eleicao.SELE_DK, Eleicao.SELE_NM_ELEICAO
            order by sum(o.URNA_VERSAO) desc
        ) where rownum <![CDATA[ < ]]> 11
    </select>


</mapper>
